

<!DOCTYPE html>


<html lang="fr" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Filtrage numérique &#8212; Traitement du signal 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jbvinc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/.ipynb_checkpoints/jbvinc-checkpoint.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'filtrage/tpc';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Bruit dans les signaux" href="../ssp/bruit.html" />
    <link rel="prev" title="Exercices sur machine" href="tp.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="fr"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Passer au contenu principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Haut de page</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Traitement du signal 2</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Recherche</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Révisions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../revisions/td.html">Exercices sur feuille</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../revisions/tdc.html">Corrections</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../revisions/tp.html">Exercices sur machine</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../revisions/tpc1.html">Représentation d’un signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../revisions/tpc2.html">Transformée de Fourier discrète</a></li>
<li class="toctree-l2"><a class="reference internal" href="../revisions/tpc3.html">Analyse spectrale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../revisions/tpc4.html">Produit de convolution</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Filtrage</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ideaux.html">Filtres idéaux</a></li>
<li class="toctree-l1"><a class="reference internal" href="realisables.html">Filtres réalisables</a></li>
<li class="toctree-l1"><a class="reference internal" href="laplace.html">Transformée de Laplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="z.html">Transformée en Z</a></li>
<li class="toctree-l1"><a class="reference internal" href="numeriques.html">Filtres numériques</a></li>
<li class="toctree-l1"><a class="reference internal" href="rif.html">Filtres RIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="rii.html">Filtres RII</a></li>
<li class="toctree-l1"><a class="reference internal" href="analogiques.html">Filtres analogiques</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="td.html">Exercices sur feuille</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="tdc.html">Corrections</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tp.html">Exercices sur machine</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Filtrage numérique</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Traitement statistique du signal</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ssp/bruit.html">Bruit dans les signaux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ssp/traitement-bruit.html">Traitement des signaux bruités</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ssp/td.html">Exercices sur feuille</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ssp/tp.html">Exercices sur machine</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modulation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../modulation/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modulation/analogique.html">Modulation analogique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modulation/bande-de-base.html">Modulation en bande de base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modulation/porteuse.html">Modulation sur porteuse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modulation/td.html">Excercices sur feuille</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modulation/tp.html">Exercices sur machine</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Annexes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://moodle.unistra.fr/course/view.php?id=6677">Moodle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/python.html">Installer et utiliser Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/refs.html">Références</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/licence.html">Licence</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Téléchargez cette page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/filtrage/tpc.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Télécharger le fichier source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimer au format PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Mode plein écran"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="clair/sombre" aria-label="clair/sombre" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Recherche" aria-label="Recherche" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Filtrage numérique</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenu </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#affichage-de-lecg-mesure">Affichage de l’ECG mesuré</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-du-gabarit">Définition du gabarit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-d-un-filtre-rif-avec-la-methode-des-fenetres">Réalisation d’un filtre RIF avec la méthode des fenêtres</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-d-un-filtre-rii-avec-la-transformation-bilineaire">Réalisation d’un filtre RII avec la transformation bilinéaire</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan">Réalisation du filtre RIF avec la méthode de Parks-McClellan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-d-un-filtre-ideal">Réalisation d’un filtre idéal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application">Application</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effet-de-la-quantification-des-coefficients">Effet de la quantification des coefficients</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="filtrage-numerique">
<h1>Filtrage numérique<a class="headerlink" href="#filtrage-numerique" title="Lien permanent vers cette rubrique">#</a></h1>
<p>Les fonctions de filtrage sont dans <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html"><code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code></a>.</p>
<section id="affichage-de-lecg-mesure">
<h2>Affichage de l’ECG mesuré<a class="headerlink" href="#affichage-de-lecg-mesure" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Connaissant le nombre de points dans le signal (<code class="docutils literal notranslate"><span class="pre">numpy.shape</span></code>) et la fréquence d’échantillonnage, il est facile de générer un vecteur des abscisses pour tracer le signal en fonction du temps.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/cca93b5abc5f8f304f6d25a53cbcfb445c7e4532234b2737ffc45546cb8f60e3.png" src="../_images/cca93b5abc5f8f304f6d25a53cbcfb445c7e4532234b2737ffc45546cb8f60e3.png" />
</div>
</div>
<p>Attention : avant de sous-échantillonner, il convient d’appliquer un filtre anti-repliement !
On peut utiliser la fonction <code class="docutils literal notranslate"><span class="pre">scipy.signal.decimate</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/368338c5b08850c7c51eeb5496ef42782765e428378ac38ca86941fd221603fc.png" src="../_images/368338c5b08850c7c51eeb5496ef42782765e428378ac38ca86941fd221603fc.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4bd8552993984a8869fdc82a8a2c9f20e7fcc9589e46de4f8ca56ff71d964add.png" src="../_images/4bd8552993984a8869fdc82a8a2c9f20e7fcc9589e46de4f8ca56ff71d964add.png" />
</div>
</div>
<p>L’observation du spectre nous permet d’affirmer que le signal ECG est plutôt basse fréquence,
mais on le savait déjà en observant le signal temporel.
La phase n’est pas interprétable ; cela arrive souvent sur les signaux réels.</p>
<p>Finalement, le spectre ne nous permet pas, ici,
de déterminer les contenus fréquentiels de la variation basse fréquence d’une part, et des ondes d’autre part.</p>
</section>
<section id="definition-du-gabarit">
<h2>Définition du gabarit<a class="headerlink" href="#definition-du-gabarit" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Or, on sait que les ondes apparaissent toutes les secondes environ (il y a dix ondes sur presque dix secondes) :
leur fréquence d’apparition est donc de l’ordre du hertz.
D’autre part, la variation basse fréquence peut être assimilée (très grossièrement) à un sinus de période sept secondes
(donc de fréquence 1/7 Hz).
Aussi, pour éliminer la composante basse fréquence, il faut réaliser un filtre passe-haut
dont la fréquence de coupure est comprise entre 1/7 Hz et 1 Hz.</p>
<p>Nous choisissons donc le gabarit représenté ci-dessous, avec une fréquence de la bande passante à 1 Hz,
et une fréquence de la bande atténuée de 0,5 Hz.
Seule l’application sur le signal nous permettra d’affiner ces deux valeurs :
c’est pourquoi il est important de réaliser un code qui utilise des variables pour ces deux fréquences, afin de les changer facilement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gabarit numérique</span>
<span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fe</span><span class="o">/</span><span class="mi">2</span>
<span class="n">fp</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">edB</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">AdB</span> <span class="o">=</span> <span class="mi">60</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/05af014cc61ee84adba790f2e9b87a669c11e0075a520e4d21930afc4fc4cc59.png" src="../_images/05af014cc61ee84adba790f2e9b87a669c11e0075a520e4d21930afc4fc4cc59.png" />
</div>
</div>
</section>
<section id="realisation-d-un-filtre-rif-avec-la-methode-des-fenetres">
<h2>Réalisation d’un filtre RIF avec la méthode des fenêtres<a class="headerlink" href="#realisation-d-un-filtre-rif-avec-la-methode-des-fenetres" title="Lien permanent vers cette rubrique">#</a></h2>
<p>D’après le <a class="reference internal" href="rif.html#s-methode-des-fenetres"><span class="std std-ref">tableau vu en cours</span></a>,
pour respecter une atténuation de 60 dB, nous pouvons utiliser les fenêtres de Blackman ou Kaiser
(à la condition que <span class="math notranslate nohighlight">\(\beta\)</span> soit suffisamment grand).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">largeur_de_transition</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp</span><span class="o">-</span><span class="n">fs</span><span class="p">)</span> <span class="o">/</span> <span class="n">fe</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ordre des fenêtres (déterminé à partir de la largeur de transition) :
Blackman :             N = 1100
Kaiser (beta = 6,76) : N = 864
Kaiser (beta = 8,96) : N = 1142
</pre></div>
</div>
</div>
</div>
<p>La fenêtre de Kaiser avec <span class="math notranslate nohighlight">\(\beta=6,76\)</span> est la fenêtre qui donne l’ordre le plus faible : c’est donc celle-ci qu’on choisit.</p>
<p>En pratique, l’ordre donné par la méthode des fenêtres est souvent trop grand.
Je choisis donc un ordre plus faible.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ordre du filtre RIF : 801
</pre></div>
</div>
<img alt="../_images/06a0335197300b74746ba9f3582e76c9cda6e683bff6c9807c7b89ac2c2cc9d4.png" src="../_images/06a0335197300b74746ba9f3582e76c9cda6e683bff6c9807c7b89ac2c2cc9d4.png" />
</div>
</div>
<p>Le filtre RIF synthétisé respecte bien le gabarit et ne génère aucune oscillation dans la bande passante.
La phase est linéaire, et donc le retard de groupe est constant.
Les deux pics visibles sur le retard de groupe sont probablement dus à des erreurs numériques.
Enfin, le filtre étant d’ordre très élevé, il existe énormément de zéros, qui sont visibles sur le diagramme pôles-zéros.
Le filtre RIF est toujours stable, aucun pôle n’existe.</p>
</section>
<section id="realisation-d-un-filtre-rii-avec-la-transformation-bilineaire">
<h2>Réalisation d’un filtre RII avec la transformation bilinéaire<a class="headerlink" href="#realisation-d-un-filtre-rii-avec-la-transformation-bilineaire" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Le gabarit analogique est le même que le gabarit numérique, à l’exception des fréquences qui sont calculées à partir de l’expression</p>
<div class="math notranslate nohighlight">
\[
f_a = \frac{f_e}{\pi} \tan\left(\pi\frac{f_n}{f_e}\right).
\]</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/219efd9be6867d94734cc0b8f3597d5d90409840e4932b556ee8ca2aca2bfd35.png" src="../_images/219efd9be6867d94734cc0b8f3597d5d90409840e4932b556ee8ca2aca2bfd35.png" />
</div>
</div>
<p>L’expression de la transformation bilinéaire permettant d’obtenir H(z) à partir de H(s) est :</p>
<div class="math notranslate nohighlight">
\[
H_n(z) = H_a\left(2f_e \left(\frac{1-z^{-1}}{1+z^{-1}}\right)\right).
\]</div>
<p>Cela dit, les formules précédentes ne sont pas nécessaires pour la synthèse du filtre RII puisque la fonction <code class="docutils literal notranslate"><span class="pre">iirdesign</span></code> effectue le schéma complet de la transformation bilinéaire :
détermination du gabarit analogique, synthèse du filtre analogique, et enfin transformation de la fonction de transfert analogique en fonction de transfert numérique.</p>
<p>La fonction utilise <code class="docutils literal notranslate"><span class="pre">ordfunc</span></code> et <code class="docutils literal notranslate"><span class="pre">iirfilter</span></code> puis la transformée bilinéaire <code class="docutils literal notranslate"><span class="pre">bilinear_zpk</span></code>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ordre du filtre RII : 6
</pre></div>
</div>
<img alt="../_images/344030f86c051a63ab828c7fdff39551861c4c7ed4ce0147f38c9cd94eacf0c5.png" src="../_images/344030f86c051a63ab828c7fdff39551861c4c7ed4ce0147f38c9cd94eacf0c5.png" />
</div>
</div>
<p>Le filtre RII synthétisé respecte bien le gabarit, quelques oscillations sont visibles dans la bande passante.
La phase évolue doucement mais présentent plusieurs « sauts ».
Les premiers sauts de phase ont une valeur de <span class="math notranslate nohighlight">\(\pi\)</span> et correspondent à une inversion de signe dans la réponse fréquentielle et se traduisent par un rebond sur le module.
Le dernier saut de phase a une valeur de <span class="math notranslate nohighlight">\(2\pi\)</span> et ne traduit aucun phénomène : ce saut existe seulement parce que la phase est ici représentée entre <span class="math notranslate nohighlight">\(-\pi\)</span> et <span class="math notranslate nohighlight">\(\pi\)</span>.
Comme la phase n’est pas linéaire, le retard de groupe n’est pas constant.
Enfin, le diagramme pôles-zéros fait apparaître des pôles qui sont tous dans le cercle unité : le filtre est donc stable.</p>
</section>
<section id="realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan">
<h2>Réalisation du filtre RIF avec la méthode de Parks-McClellan<a class="headerlink" href="#realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan" title="Lien permanent vers cette rubrique">#</a></h2>
<p>En général, la méthode de Parks-McClellan es très intéressante et fournit des filtres RIF d’ordre moins élevés que ceux produits avec la méthode des fenêtres.
Mais dans notre cas, cette méthode ne donne pas de résultat satisfaisant (le gabarit n’est pas du tout respecté) car la bande de transition est très faible et très à gauche dans les fréquences.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/bdb7e580da3ab3f35159e694bf831ced3ef7de0ff542d966612bcc7cb674d21b.png" src="../_images/bdb7e580da3ab3f35159e694bf831ced3ef7de0ff542d966612bcc7cb674d21b.png" />
</div>
</div>
</section>
<section id="realisation-d-un-filtre-ideal">
<h2>Réalisation d’un filtre idéal<a class="headerlink" href="#realisation-d-un-filtre-ideal" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Comme le signal ECG est enregistré, on peut y appliquer un filtre idéal en travaillant dans le domaine de Fourier.
Pour cela, on multiplie le spectre du signal par une réponse fréquentielle nulle pour les fréquences inférieures à la fréquence de coupure, et égale à 1 au delà.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3ce8f06b3f22134c11bcc40429ff39ada4938ed8d1f6ae79633350a68fd54722.png" src="../_images/3ce8f06b3f22134c11bcc40429ff39ada4938ed8d1f6ae79633350a68fd54722.png" />
</div>
</div>
<p>Le module du filtre idéal correspond bien à une porte.
Dans la représentation ci-dessous, la porte n’est visible que pour des fréquences supérieures à la fréquence de coupure car le module est tracé en échelle logarithmique, donc les amplitudes nulles de la réponse fréquentielle sont renvoyées en <span class="math notranslate nohighlight">\(-\infty\)</span>.
La phase est linéaire et même constante ; on ne représente pas le retard de groupe qui serait nul.
Enfin, le filtre n’ayant pas d’expression sous forme de fonction de transfert, on ne peut pas définir des pôles et des zéros et on ne peut donc pas représenter son diagramme pôles-zéros.</p>
</section>
<section id="application">
<h2>Application<a class="headerlink" href="#application" title="Lien permanent vers cette rubrique">#</a></h2>
<p>Nous représentons ci-dessous le signal temporel et son spectre du signal ECG original et des sorties des filtres (RIF, RII et idéal).</p>
<p>On observe que le filtre RIF donne un signal filtré plus « propre » (d’un point de vue médical) que le filtre RII.
Le filtre idéal est quant à lui encore meilleur.
Cela s’explique par le fait qu’il ne génère aucune oscillation, ni en bande atténuée ni en bande passante,
et que par ailleurs le signal basse fréquence de l’ECG est spectralement très différent du signal d’intérêt : on peut donc les séparer proprement par filtrage des fréquences.</p>
<p>Enfin, on peut également observer le retard de groupe important sur le filtre RIF.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/89e2f0125057a642886d1a28d1a87c78c54f6ca5c1f34ac478fb8f975e1ea82f.png" src="../_images/89e2f0125057a642886d1a28d1a87c78c54f6ca5c1f34ac478fb8f975e1ea82f.png" />
<img alt="../_images/d0582f4d6aac442e47f8b919b2758d59bca1e97a7b6d6b43f5c351ee166f3a60.png" src="../_images/d0582f4d6aac442e47f8b919b2758d59bca1e97a7b6d6b43f5c351ee166f3a60.png" />
<img alt="../_images/2d5d3d334befdaf53e0af12cee3402e539669e743eb20b683c3e58ba0d99ce3e.png" src="../_images/2d5d3d334befdaf53e0af12cee3402e539669e743eb20b683c3e58ba0d99ce3e.png" />
<img alt="../_images/f3f363a6ea389fd7127d0461c811c63beba8e84ebe96f5101e776865d7279413.png" src="../_images/f3f363a6ea389fd7127d0461c811c63beba8e84ebe96f5101e776865d7279413.png" />
</div>
</div>
</section>
<section id="effet-de-la-quantification-des-coefficients">
<h2>Effet de la quantification des coefficients<a class="headerlink" href="#effet-de-la-quantification-des-coefficients" title="Lien permanent vers cette rubrique">#</a></h2>
<p>En se concentrant sur les deux filtres à réaliser dans ce TP (le filtre RIF et le filtre RII), on constate que la précision des coefficients est importantes.
Dans les figures ci-dessous, on a représenté le gain de la réponse fréquentielle des deux filtres en n’utilisant que certains chiffres décimaux des coefficients : une troncature est donc effectuée.
On constate que le filtre RIF est plus stable à cette troncature car il respecte le gabarit même si peu de chiffres sont conservés.
Cela indique donc que la mémoire utilisée par chaque coefficient peut être moindre avec un filtre RIF qu’avec un filtre RII.
Mais ce gain possible en mémoire est contrebalancé par le fait que le filtre RIF nécessite beaucoup plus de coefficients que le filtre RII.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4f94d21266be98a22f5ad872e8de65155fac59415235eec5392db7fd8e9bce6e.png" src="../_images/4f94d21266be98a22f5ad872e8de65155fac59415235eec5392db7fd8e9bce6e.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./filtrage"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tp.html"
       title="page précédente">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">précédent</p>
        <p class="prev-next-title">Exercices sur machine</p>
      </div>
    </a>
    <a class="right-next"
       href="../ssp/bruit.html"
       title="page suivante">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Bruit dans les signaux</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenu
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#affichage-de-lecg-mesure">Affichage de l’ECG mesuré</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-du-gabarit">Définition du gabarit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-d-un-filtre-rif-avec-la-methode-des-fenetres">Réalisation d’un filtre RIF avec la méthode des fenêtres</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-d-un-filtre-rii-avec-la-transformation-bilineaire">Réalisation d’un filtre RII avec la transformation bilinéaire</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan">Réalisation du filtre RIF avec la méthode de Parks-McClellan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#realisation-d-un-filtre-ideal">Réalisation d’un filtre idéal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application">Application</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effet-de-la-quantification-des-coefficients">Effet de la quantification des coefficients</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Par Vincent Mazet (Université de Strasbourg, France)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Traitement du signal 2 &mdash; Vincent Mazet (Université de Strasbourg), 2020-2026 &mdash; <a href='licence.html'>CC BY-NC 4.0</a>.
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>